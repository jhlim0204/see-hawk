<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: SearchUI/SearchPage.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: SearchUI/SearchPage.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/* View Component*/
import React, { Component } from 'react';
import { Col, FormGroup, Row, Label, Input, Form } from 'reactstrap';
import HawkerResult from './HawkerResult';
import Lottie from 'lottie-react';
import SearchEmptyAnimation from '../Animation/searchEmpty.json';
import { withRouter } from '../Utility/withRouter';
import DisplayStarsSmall from '../Utility/DisplayStarsSmall';

/* Placeholder Component*/
import SidebarPlaceholder from '../PlaceholderUI/SidebarPlaceholder';
import HawkerPlaceholder from '../PlaceholderUI/HawkerPlaceholder';

/* Controller*/
import { HawkerCentreManager } from '../../control/HawkerCentreManager';
import { FilterManager } from '../../control/FilterManager';




class SearchPage extends Component {

    /**

Initializes the state of the component with isLoading, oriSearchResult, searchResult, star, and region.
@param {*} props the properties passed down from the parent component
*/
    constructor(props) {
        super(props);


/**

Represents the state of a component that contains properties related to search results, loading status, star count, and region filtering.
@constructor
@param {boolean} isLoading - A boolean value indicating whether the search results are currently being loaded.
@param {Array} oriSearchResult - An array of original search results.
@param {Array} searchResult - An array of filtered search results.
@param {number} star - A numeric value representing the number of stars for a given search result.
@param {Object} region - An object containing boolean properties representing the region filter for search results.
@param {boolean} region.W - A boolean value indicating whether search results are filtered by the western region.
@param {boolean} region.E - A boolean value indicating whether search results are filtered by the eastern region.
@param {boolean} region.N - A boolean value indicating whether search results are filtered by the northern region.
@param {boolean} region.NE - A boolean value indicating whether search results are filtered by the northeastern region.
@param {boolean} region.C - A boolean value indicating whether search results are filtered by the central region.
*/

        this.state = {
            isLoading: true,
            oriSearchResult: [],
            searchResult: [],
            star: 0,
            region: {
                W: false,
                E: false,
                N: false,
                NE: false,
                C: false
            }
        };
    }
/**

Handles the search function by calling the searchHawkerCentre function of the HawkerCentreManager controller
and setting the state of isLoading and searchResult accordingly.
*/
    handleSearch = async () => {
        this.setState({ isLoading: true });

        const { search } = this.props.location;
        const urlQuery = new URLSearchParams(search);
        const qParam = urlQuery.get('q');
        let resultList = [];
        if (qParam &amp;&amp; qParam.trim() !== '') {
            resultList = await HawkerCentreManager.searchHawkerCentre(qParam);
        }

        this.setState({ searchResult: resultList, oriSearchResult: resultList, isLoading: false });
    };
/**

Handles filtering the search results based on star rating and location.
Filters the oriSearchResult by passing it to the FilterManager's filter function and updating the state
of searchResult with the resulting array.
*/
    handleFilter = () => {
        /* ori search result*/
        this.setState({
            searchResult: FilterManager.filter(this.state.oriSearchResult, {
                star: this.state.star,
                region: this.state.region
            })
        });
    };
/**

Handles updating the state of star based on the selected star rating.
Calls handleFilter to update the search results.
@param {*} event the event object passed in from the onChange handler
*/
    handleRating = (event) => {
        this.setState({ star: parseInt(event.target.value) }, () => {
            this.handleFilter();
        });
    };
/**

Handles updating the state of the location checkboxes based on which checkboxes were clicked.
Calls handleFilter to update the search results.
@param {*} event the event object passed in from the onChange handler
*/
    handleRegion = (event) => {
        let regionCopy = { ...this.state.region };
        regionCopy[event.target.name] = !regionCopy[event.target.name];
        this.setState({ region: regionCopy }, () => {
            this.handleFilter();
        });
    };

    render() {
        if (this.state.isLoading) {
            return (
                &lt;div className='background page-transition'>
                    &lt;Row>
                        &lt;SidebarPlaceholder />
                        &lt;Col xs={9}>
                            &lt;HawkerPlaceholder />
                        &lt;/Col>
                    &lt;/Row>
                &lt;/div>
            );
        } else {
            return (
                &lt;div className='background'>
                    &lt;Row>
                        &lt;Col xs={3} className='rounded-3 content shadow-sm'>
                            &lt;h5 className='mb-4'>
                                &lt;i className='bi bi-funnel' /> FILTERS
                            &lt;/h5>
                            &lt;h6 className='mb-3'>Star Rating&lt;/h6>
                            &lt;Form className='filter-form'>
                                &lt;FormGroup check>
                                    &lt;Label check>
                                        &lt;Input
                                            name='star'
                                            type='radio'
                                            value={5}
                                            onChange={this.handleRating}
                                            checked={this.state.star === 5}
                                        />
                                        &lt;DisplayStarsSmall activeCount={5} />
                                    &lt;/Label>
                                &lt;/FormGroup>
                                &lt;FormGroup check>
                                    &lt;Label check>
                                        &lt;Input
                                            name='star'
                                            type='radio'
                                            value={4}
                                            onChange={this.handleRating}
                                            checked={this.state.star === 4}
                                        />
                                        &lt;DisplayStarsSmall activeCount={4} /> &amp; Up
                                    &lt;/Label>
                                &lt;/FormGroup>
                                &lt;FormGroup check>
                                    &lt;Label check>
                                        &lt;Input
                                            name='star'
                                            type='radio'
                                            value={3}
                                            onChange={this.handleRating}
                                            checked={this.state.star === 3}
                                        />
                                        &lt;DisplayStarsSmall activeCount={3} /> &amp; Up
                                    &lt;/Label>
                                &lt;/FormGroup>
                                &lt;FormGroup check>
                                    &lt;Label check>
                                        &lt;Input
                                            name='star'
                                            type='radio'
                                            value={2}
                                            onChange={this.handleRating}
                                            checked={this.state.star === 2}
                                        />
                                        &lt;DisplayStarsSmall activeCount={2} /> &amp; Up
                                    &lt;/Label>
                                &lt;/FormGroup>
                                &lt;FormGroup check>
                                    &lt;Label check>
                                        &lt;Input
                                            name='star'
                                            type='radio'
                                            value={1}
                                            onChange={this.handleRating}
                                            checked={this.state.star === 1}
                                        />
                                        &lt;DisplayStarsSmall activeCount={1} /> &amp; Up
                                    &lt;/Label>
                                &lt;/FormGroup>
                                &lt;FormGroup check>
                                    &lt;Label check>
                                        &lt;Input
                                            name='star'
                                            type='radio'
                                            value={0}
                                            onChange={this.handleRating}
                                            checked={this.state.star === 0}
                                        />
                                        &lt;DisplayStarsSmall activeCount={0} /> &amp; Up
                                    &lt;/Label>
                                &lt;/FormGroup>
                            &lt;/Form>
                            &lt;div className='line my-4' />
                            &lt;h6 className='mb-3'>Located Region&lt;/h6>
                            &lt;Form className='filter-form'>
                                &lt;FormGroup check>
                                    &lt;Label check>
                                        &lt;Input
                                            type='checkbox'
                                            name='W'
                                            checked={this.state.region.W}
                                            onChange={this.handleRegion}
                                        />
                                        West Region
                                    &lt;/Label>
                                &lt;/FormGroup>
                                &lt;FormGroup check>
                                    &lt;Label check>
                                        &lt;Input
                                            type='checkbox'
                                            name='E'
                                            checked={this.state.region.E}
                                            onChange={this.handleRegion}
                                        />
                                        East Region
                                    &lt;/Label>
                                &lt;/FormGroup>
                                &lt;FormGroup check>
                                    &lt;Label check>
                                        &lt;Input
                                            type='checkbox'
                                            name='N'
                                            checked={this.state.region.N}
                                            onChange={this.handleRegion}
                                        />
                                        North Region
                                    &lt;/Label>
                                &lt;/FormGroup>
                                &lt;FormGroup check>
                                    &lt;Label check>
                                        &lt;Input
                                            type='checkbox'
                                            name='NE'
                                            checked={this.state.region.NE}
                                            onChange={this.handleRegion}
                                        />
                                        North-East Region
                                    &lt;/Label>
                                &lt;/FormGroup>
                                &lt;FormGroup check>
                                    &lt;Label check>
                                        &lt;Input
                                            type='checkbox'
                                            name='C'
                                            checked={this.state.region.C}
                                            onChange={this.handleRegion}
                                        />
                                        Central Region
                                    &lt;/Label>
                                &lt;/FormGroup>
                            &lt;/Form>
                        &lt;/Col>
                        &lt;Col xs={9}>
                            {this.state.searchResult.length !== 0 ? (
                                this.state.searchResult.map((result) => (
                                    &lt;HawkerResult
                                        key={result.id}
                                        name={result.name}
                                        address={result.address}
                                        noOfStall={result.noOfStall}
                                        id={result.id}
                                        photoURL={result.photoURL}
                                        averageRating={result.averageRating}
                                    />
                                ))
                            ) : (
                                &lt;>
                                    &lt;div className='mt-5 d-flex justify-content-center'>
                                        &lt;Lottie
                                            loop={false}
                                            animationData={SearchEmptyAnimation}
                                            style={{ height: 180 }}
                                        />
                                    &lt;/div>
                                    &lt;div className='mt-2 d-flex justify-content-center'>
                                        &lt;h4 className='fw-semibold text-center'>
                                            No results found.
                                        &lt;/h4>
                                    &lt;/div>
                                &lt;/>
                            )}
                        &lt;/Col>
                    &lt;/Row>
                &lt;/div>
            );
        }
    }

    componentDidMount() {
        this.handleSearch();
        document.title = 'Search Results - SeeHawk';
    }
}

export default withRouter(SearchPage);
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="HawkerPlaceholder.html">HawkerPlaceholder</a></li><li><a href="HawkerResult.html">HawkerResult</a></li><li><a href="Login.html">Login</a></li><li><a href="Logout.html">Logout</a></li><li><a href="Profile.html">Profile</a></li><li><a href="global.html#Register">Register</a></li><li><a href="SearchBar.html">SearchBar</a></li><li><a href="SearchPage.html">SearchPage</a></li><li><a href="SearchPage_state.html">state</a></li><li><a href="SidebarPlaceholder.html">SidebarPlaceholder</a></li></ul><h3>Global</h3><ul><li><a href="global.html#DisplayStarsSmall">DisplayStarsSmall</a></li><li><a href="global.html#HawkerPagePlaceholder">HawkerPagePlaceholder</a></li><li><a href="global.html#LoginRegisterModal">LoginRegisterModal</a></li><li><a href="global.html#ReviewPagePlaceholder">ReviewPagePlaceholder</a></li><li><a href="global.html#withRouter">withRouter</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.11</a> on Wed Mar 22 2023 19:46:02 GMT+0800 (Singapore Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
